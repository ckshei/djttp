<h1>DJTTP: Events</h1>
  <div class="row event">
    <div id="error-messages">
      
    </div>
    <%= form_for @event do |f| %>
      <div class="col-xs-12">
        Name: <%= f.text_field :name, :required => true %>
        Date: <%= f.date_field :date, :required => true %>
      </div>
      <div class="col-xs-12">
        
      </div>
    <%= f.hidden_field :host_id, :value=>@current_user.id %>
    <%= f.submit %>
    <% end %>
  </div>


  <ul id="events-list">
    
  </ul>

<script type="text/javascript" charset="utf-8">
 $(function () {
   $('form').submit(function(event) {
     event.preventDefault();

     var values = $(this).serialize();
     var posting = $.post('/events', values);

     posting.done(function(event) {
       if (event.id) {
       var ev = new Event(event.id, event.name, event.date, event.playlist.spotify_url, event.playlist.rsvp_url, event.guest_count, event.event_url)
       var markup = ev.createDiv()
       $("#events-list").append(markup)
       } else {
         $("#error-messages").html(event.date[0])
       }
     });
   });
 }); 
</script>
